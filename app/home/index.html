<form method="post" id="add_new">
  <div class="form-group">
    <label for="lastName">Фамілія</label>
    <input
      type="text"
      id="lastName"
      class="form-control"
      ng-model="vm.user.lastName"
      required
    />
  </div>
  <div class="form-group">
    <label for="firstName">Ім'я</label>
    <input
      type="text"
      id="firstName"
      class="form-control"
      ng-model="vm.user.firstName"
      required
    />
  </div>
  <div class="form-group">
    <label for="lastName">Побатькові</label>
    <input
      type="text"
      id="lastName"
      class="form-control"
      ng-model="vm.user.lastName"
      required
    />
  </div>
  <div class="form-group">
    <label for="username">Мета візиту</label>
    <input
      type="text"
      id="username"
      class="form-control"
      ng-model="vm.user.username"
      required
    />
  </div>

  <div class="form-group upload">
    <label class="u1" for="userIdFoto">Фото особи</label>
    <img class="u1" id="_1" src="" alt="" srcset="" />
    <label for="file1" class="btn btn-default input-group-addon"
      >Обрати файл</label
    >
    <input type="file" onchange="previewFile('_1')" id="file1" />
    <input
      type="text"
      class="form-control"
      placeholder="Username"
      aria-describedby="basic-addon1"
    />
  </div>

  <div class="form-group upload">
    <label class="u2" for="userIdFoto">Фото документа що посвідчує особу</label>
    <img class="u2" id="_2" src="" alt="" srcset="" />
    <label for="file2" class="btn btn-default input-group-addon"
      >Обрати файл</label
    >
    <input type="file" onchange="previewFile('_2')" id="file2" />
    <input
      type="text"
      class="form-control"
      placeholder="Username"
      aria-describedby="basic-addon1"
    />
  </div>

  <div class="form-group">
    <button type="submit" id="submitButton" ng-click="vm.addNew()" class="btn btn-success">
      Зареєструвати
    </button>
  </div>
</form>

<script>
  function previewFile(img) {
    var preview = document.getElementById(img);
    var file = document.querySelector("input[type=file]").files[0];
    var reader = new FileReader();

    reader.addEventListener(
      "load",
      function() {
        preview.src = reader.result;
      },
      false
    );

    if (file) {
      reader.readAsDataURL(file);
    }
  }

  $("#add1_new").submit(function(event) {
    event.preventDefault();
    var formData = $("#add_new").serialize();
    var url_str = "/api/users/asd";

    $.ajax({
      type: "POST",
      url: url_str,
      data: formData
    })
      .done(function(response) {
        $(".overflow").toggle();
        console.log("ok" + response);
        alert(
          "Ваше сообщение отправлено, вскоре с Вами свяжется наш специалист."
        );
        $("#add_new input").val("");
      })
      .fail(function(data) {
        if (data.responseText !== "") {
          console.log("error" + " " + data);
          alert("error:" + data);
        } else {
          console.log(
            "При отправке сообщения произошла ошибка, попробуйте пожалуйста еще раз."
          );
          alert(
            "При отправке сообщения произошла ошибка, попробуйте пожалуйста еще раз."
          );
        }
        $(".overflow").toggle();
      });
  });
</script>
